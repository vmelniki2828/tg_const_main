#!/bin/bash

echo "üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤..."

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
docker-compose -f docker-compose.yml down

# –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö
echo "üóëÔ∏è –û—á–∏—â–∞–µ–º —Ñ–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö..."
echo '{"bots": [], "activeBot": null}' > backend/editorState.json
echo '{}' > backend/quizStats.json

# –û—á–∏—Å—Ç–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
echo "üóëÔ∏è –û—á–∏—â–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..."
rm -rf backend/uploads/*

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
echo "üî® –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º..."
docker-compose -f docker-compose.yml up --build -d

# –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ
echo "‚è≥ –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞..."
sleep 15

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
echo "üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç..."
docker-compose -f docker-compose.yml ps

echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "üåê –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: http://95.164.119.96:3000"
echo "üîß –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±–æ—Ç–æ–≤ –æ—á–∏—â–µ–Ω—ã!" 