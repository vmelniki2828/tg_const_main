# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ `createKeyboardWithBack` –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞–ª–∏ –æ—à–∏–±–∫—É "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ /start –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞."

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–î–æ–±–∞–≤–ª–µ–Ω `await`** –∫–æ –≤—Å–µ–º –≤—ã–∑–æ–≤–∞–º `createKeyboardWithBack`
2. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `createKeyboardWithBack`
3. **–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º
4. **–î–æ–±–∞–≤–ª–µ–Ω fallback** - –ø—É—Å—Ç–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞:

```javascript
// –ë—ã–ª–æ:
const { keyboard, inlineKeyboard } = createKeyboardWithBack(nextQuestion.buttons, userId, quizState.blockId);

// –°—Ç–∞–ª–æ:
const { keyboard, inlineKeyboard } = await createKeyboardWithBack(nextQuestion.buttons, userId, quizState.blockId);
```

### –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `createKeyboardWithBack`:

```javascript
async function createKeyboardWithBack(buttons, userId, currentBlockId) {
  try {
    console.log(`üîç DEBUG: createKeyboardWithBack called for user ${userId}, block ${currentBlockId}`);
    
    // ... –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã ...
    
    console.log(`üîç DEBUG: createKeyboardWithBack completed, keyboard length: ${keyboard.length}`);
    return { keyboard, inlineKeyboard };
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –≤ createKeyboardWithBack:', error);
    console.error('‚ùå Stack trace:', error.stack);
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤ caso –æ—à–∏–±–∫–∏
    return { keyboard: [], inlineKeyboard: [] };
  }
}
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –í—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–∏ `createKeyboardWithBack`
- –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ —Å stack trace
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–æ–ø–æ–∫ –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- Try-catch –±–ª–æ–∫ –≤ `createKeyboardWithBack`
- Fallback –Ω–∞ –ø—É—Å—Ç—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ‚úÖ **–ö–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–ù–∞–≤–∏–≥–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç** –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
- ‚úÖ **–û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è** gracefully

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–í–æ–π–¥–∏—Ç–µ –≤ –±–æ—Ç–∞** - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
2. **–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É** - –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–π—Ç–∏ –≤ –±–ª–æ–∫
3. **–ù–∞–∂–º–∏—Ç–µ "–ù–∞–∑–∞–¥"** - –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è —Å –∫–Ω–æ–ø–∫–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è DEBUG

## üö® –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend'–∞:
```bash
docker compose logs backend | tail -50
```

–ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
- `üîç DEBUG: createKeyboardWithBack called`
- `‚ùå –û—à–∏–±–∫–∞ –≤ createKeyboardWithBack`
- `üîç DEBUG: Error details`
