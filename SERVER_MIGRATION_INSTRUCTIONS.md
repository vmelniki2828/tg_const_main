# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ MongoDB –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh root@157.230.20.252
cd /home/tg_const_main
```

### 2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
```bash
docker compose down
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ MongoDB
```bash
docker compose up -d mongodb
```

### 4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–ø—É—Å–∫–∞ MongoDB (30 —Å–µ–∫—É–Ω–¥)
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker compose ps mongodb

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs mongodb
```

### 5. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö —Å –≤–Ω–µ—à–Ω–µ–π MongoDB
```bash
# –ï—Å–ª–∏ mongodump –¥–æ—Å—Ç—É–ø–µ–Ω
mongodump --uri="mongodb://157.230.20.252:27017/tg_const_main" --out=./mongo-backup-$(date +%Y%m%d_%H%M%S)

# –ò–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ API
curl -s http://157.230.20.252:3001/api/bots > bots-backup.json
```

### 6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
```bash
docker compose up -d
```

### 7. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ MongoDB
docker compose exec mongodb mongosh --eval "db.adminCommand('ping')"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ—Ç–æ–≤ –≤ –Ω–æ–≤–æ–π –ë–î
docker compose exec mongodb mongosh tg_const_main --eval "db.bots.countDocuments()"
```

### 8. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É API
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl -s http://157.230.20.252:3001/api/bots

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl -s http://157.230.20.252:3001/api/health
```

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –≤–Ω–µ—à–Ω–µ–π MongoDB:

1. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API:**
```bash
# –ë–æ—Ç—ã
curl -s http://157.230.20.252:3001/api/bots > bots-backup.json

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
curl -s http://157.230.20.252:3001/api/users > users-backup.json

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–≤–∏–∑–æ–≤
curl -s http://157.230.20.252:3001/api/quiz-stats > quiz-stats-backup.json
```

2. **–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:**
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
# –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
```

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- **MongoDB –≤ Docker** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–µ–∫—Å—ã** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **Health checks** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏—Å—á–µ–∑–Ω—É—Ç

### ‚ö†Ô∏è –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:
- **MONGO_URI** —Ç–µ–ø–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é MongoDB
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** backend –æ—Ç MongoDB
- **–°–æ–∑–¥–∞–Ω volume** –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
# 1. MongoDB –∑–∞–ø—É—â–µ–Ω–∞
docker compose ps mongodb

# 2. Backend –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ MongoDB
docker compose logs backend | grep "MongoDB connected"

# 3. API —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -s http://157.230.20.252:3001/api/health

# 4. –ë–æ—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã
curl -s http://157.230.20.252:3001/api/bots
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –õ–æ–≥–∏ MongoDB
docker compose logs mongodb --tail=50

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
docker compose exec mongodb mongosh tg_const_main --eval "
print('–ë–æ—Ç—ã:', db.bots.countDocuments());
print('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:', db.users.countDocuments());
print('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–≤–∏–∑–æ–≤:', db.quizstats.countDocuments());
"
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:
- ‚úÖ **–ë–æ—Ç—ã –Ω–µ –±—É–¥—É—Ç –∏—Å—á–µ–∑–∞—Ç—å** –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ü–æ–≤—ã—Å–∏—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **–£–ª—É—á—à–∏—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (–ª–æ–∫–∞–ª—å–Ω–∞—è –ë–î)
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –ø—Ä–∏ —Å–±–æ—è—Ö
